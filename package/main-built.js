/*!
 * flow.js JavaScript Library v0.1.0
 * https://github.com/it-ony/flow.js
 *
 * Copyright 2012, Tony Findeisen
 * Licensed under the MIT license.
 * https://raw.github.com/it-ony/flow.js/master/LICENSE
 *
 * Date: Mon Mar 12 2012 12:36:34 GMT+0100 (CET)
 */
define("js/core/BindingParser",[],function(){var a={parse:function(a,b){function i(a,b,c){var d=a,e=c-a.length;for(var f=0;f<e;f++)d=b+d;return d}function j(a){var b=a.charCodeAt(0);if(b<=255)var c="x",d=2;else var c="u",d=4;return"\\"+c+i(b.toString(16).toUpperCase(),"0",d)}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,j)+'"'}function l(a){if(d<f)return;d>f&&(f=d,g=[]),g.push(a)}function m(){var b="varName@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d).match(/^[a-zA-Z$_]/)!==null){var i=a.charAt(d);d++}else{var i=null;e&&l("[a-zA-Z$_]")}if(i!==null){var j=[];if(a.substr(d).match(/^[a-zA-Z0-9$_\- ]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[a-zA-Z0-9$_\\- ]")}while(k!==null){j.push(k);if(a.substr(d).match(/^[a-zA-Z0-9$_\- ]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[a-zA-Z0-9$_\\- ]")}}if(j!==null)var m=[i,j];else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a,b){return a?a+b.join(""):!1}(m[0],m[1]):null;if(n!==null)var o=n;else{var o=null;d=f}if(o!==null)var p=o;else{var q=d,r=[];if(r!==null)var p=r;else var p=null}return h[b]={nextPos:d,result:p},p}function n(){var a="var@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=d,e=m(),f=e!==null?function(a){return{name:a,type:"var"}}(e):null;if(f!==null)var g=f;else{var g=null;d=c}return h[a]={nextPos:d,result:g},g}function o(){var b="string@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="'"){var i="'";d+=1}else{var i=null;e&&l('"\'"')}if(i!==null){var j=[],k=d;if(a.length>d){var m=a.charAt(d);d++}else{var m=null;e&&l("any character")}var n=m!==null?function(a){return a==="'"?null:a}(m):null;if(n!==null)var o=n;else{var o=null;d=k}while(o!==null){j.push(o);var k=d;if(a.length>d){var m=a.charAt(d);d++}else{var m=null;e&&l("any character")}var n=m!==null?function(a){return a==="'"?null:a}(m):null;if(n!==null)var o=n;else{var o=null;d=k}}if(j!==null){if(a.substr(d,1)==="'"){var p="'";d+=1}else{var p=null;e&&l('"\'"')}if(p!==null)var q=[i,j,p];else{var q=null;d=g}}else{var q=null;d=g}}else{var q=null;d=g}var r=q!==null?function(a){return a.join("")}(q[1]):null;if(r!==null)var s=r;else{var s=null;d=f}return h[b]={nextPos:d,result:s},s}function p(){var b="number@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d;if(a.substr(d).match(/^[0-9]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[0-9]")}if(g!==null){var i=[];while(g!==null){i.push(g);if(a.substr(d).match(/^[0-9]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[0-9]")}}}else var i=null;var j=i!==null?function(a){return parseInt(a.join(""),10)}(i):null;if(j!==null)var k=j;else{var k=null;d=f}return h[b]={nextPos:d,result:k},k}function q(){var a="parameter@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=o();if(c!==null)var e=c;else{var f=p();if(f!==null)var e=f;else{var g=x();if(g!==null)var e=g;else{var i=v();if(i!==null)var e=i;else var e=null}}}return h[a]={nextPos:d,result:e},e}function r(){var b="parameterArray@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=q(),j=i!==null?i:"";if(j!==null){var k=[],m=d,n=d;if(a.substr(d,1)===","){var o=",";d+=1}else{var o=null;e&&l('","')}if(o!==null){var p=q();if(p!==null)var r=[o,p];else{var r=null;d=n}}else{var r=null;d=n}var s=r!==null?function(a){return a}(r[1]):null;if(s!==null)var t=s;else{var t=null;d=m}while(t!==null){k.push(t);var m=d,n=d;if(a.substr(d,1)===","){var o=",";d+=1}else{var o=null;e&&l('","')}if(o!==null){var p=q();if(p!==null)var r=[o,p];else{var r=null;d=n}}else{var r=null;d=n}var s=r!==null?function(a){return a}(r[1]):null;if(s!==null)var t=s;else{var t=null;d=m}}if(k!==null)var u=[j,k];else{var u=null;d=g}}else{var u=null;d=g}var v=u!==null?function(a,b){return a?[a].concat(b):[]}(u[0],u[1]):null;if(v!==null)var w=v;else{var w=null;d=f}return h[b]={nextPos:d,result:w},w}function s(){var b="fnc@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=m();if(i!==null){if(a.substr(d,1)==="("){var j="(";d+=1}else{var j=null;e&&l('"("')}if(j!==null){var k=r(),n=k!==null?k:"";if(n!==null){if(a.substr(d,1)===")"){var o=")";d+=1}else{var o=null;e&&l('")"')}if(o!==null)var p=[i,j,n,o];else{var p=null;d=g}}else{var p=null;d=g}}else{var p=null;d=g}}else{var p=null;d=g}var q=p!==null?function(a,b){return{name:a,type:"fnc",parameter:b}}(p[0],p[2]):null;if(q!==null)var s=q;else{var s=null;d=f}return h[b]={nextPos:d,result:s},s}function t(){var a="pathElement@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=s();if(c!==null)var e=c;else{var f=n();if(f!==null)var e=f;else var e=null}return h[a]={nextPos:d,result:e},e}function u(){var b="path@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=t();if(i!==null){var j=[],k=d,m=d;if(a.substr(d,1)==="."){var n=".";d+=1}else{var n=null;e&&l('"."')}if(n!==null){var o=t();if(o!==null)var p=[n,o];else{var p=null;d=m}}else{var p=null;d=m}var q=p!==null?function(a){return a}(p[1]):null;if(q!==null)var r=q;else{var r=null;d=k}while(r!==null){j.push(r);var k=d,m=d;if(a.substr(d,1)==="."){var n=".";d+=1}else{var n=null;e&&l('"."')}if(n!==null){var o=t();if(o!==null)var p=[n,o];else{var p=null;d=m}}else{var p=null;d=m}var q=p!==null?function(a){return a}(p[1]):null;if(q!==null)var r=q;else{var r=null;d=k}}if(j!==null)var s=[i,j];else{var s=null;d=g}}else{var s=null;d=g}var u=s!==null?function(a,b){return[a].concat(b)}(s[0],s[1]):null;if(u!==null)var v=u;else{var v=null;d=f}return h[b]={nextPos:d,result:v},v}function v(){var b="binding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="{"){var i="{";d+=1}else{var i=null;e&&l('"{"')}if(i!==null){var j=u();if(j!==null){if(a.substr(d,1)==="}"){var k="}";d+=1}else{var k=null;e&&l('"}"')}if(k!==null)var m=[i,j,k];else{var m=null;d=g}}else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a){return a?{path:a,type:"normal"}:!1}(m[1]):null;if(n!==null)var o=n;else{var o=null;d=f}return h[b]={nextPos:d,result:o},o}function w(){var b="twoWayBinding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="{"){var i="{";d+=1}else{var i=null;e&&l('"{"')}if(i!==null){var j=v();if(j!==null){if(a.substr(d,1)==="}"){var k="}";d+=1}else{var k=null;e&&l('"}"')}if(k!==null)var m=[i,j,k];else{var m=null;d=g}}else{var m=null;d=g}}else{var m=null;d=g}var n=m!==null?function(a){return a.type="twoWay",a}(m[1]):null;if(n!==null)var o=n;else{var o=null;d=f}return h[b]={nextPos:d,result:o},o}function x(){var b="staticBinding@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d;if(a.substr(d,1)==="$"){var i="$";d+=1}else{var i=null;e&&l('"$"')}if(i!==null){var j=v();if(j!==null)var k=[i,j];else{var k=null;d=g}}else{var k=null;d=g}var m=k!==null?function(a){return a.type="static",a}(k[1]):null;if(m!==null)var n=m;else{var n=null;d=f}return h[b]={nextPos:d,result:n},n}function y(){var b="text@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=w(),i=g!==null?function(a){return[a]}(g):null;if(i!==null)var j=i;else{var j=null;d=f}if(j!==null)var k=j;else{var m=[],n=x();if(n!==null)var o=n;else{var p=v();if(p!==null)var o=p;else{if(a.length>d){var q=a.charAt(d);d++}else{var q=null;e&&l("any character")}if(q!==null)var o=q;else var o=null}}while(o!==null){m.push(o);var n=x();if(n!==null)var o=n;else{var p=v();if(p!==null)var o=p;else{if(a.length>d){var q=a.charAt(d);d++}else{var q=null;e&&l("any character")}if(q!==null)var o=q;else var o=null}}}if(m!==null)var k=m;else var k=null}return h[b]={nextPos:d,result:k},k}function z(){function b(a){a.sort();var b=null,c=[];for(var d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(g),e=Math.max(d,f),h=e<a.length?k(a.charAt(e)):"end of input";return"Expected "+c+" but "+h+" found."}function A(){var b=1,c=1,d=!1;for(var e=0;e<f;e++){var g=a.charAt(e);g==="\n"?(d||b++,c=1,d=!1):g==="\r"|g==="\u2028"||g==="\u2029"?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}var c={binding:v,fnc:s,number:p,parameter:q,parameterArray:r,path:u,pathElement:t,staticBinding:x,string:o,text:y,twoWayBinding:w,"var":n,varName:m};if(b!==undefined){if(c[b]===undefined)throw new Error("Invalid rule name: "+k(b)+".")}else b="text";var d=0,e=!0,f=0,g=[],h={},B=c[b]();if(B===null||d!==a.length){var C=A();throw new this.SyntaxError(z(),C.line,C.column)}return B},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a});var inherit;(function(a,b){inherit=function(a,b,c){arguments.length!==3&&(c=b,b=a,a=null),c=c||Object;var d=function(){if(this.ctor)return this.ctor.apply(this,arguments)};if(c.constructor==Function){function e(){}e.prototype=c.prototype,d.prototype=new e,d.prototype.constructor=b,b&&a&&(d.prototype.constructor.name=a),d.prototype.base=c.prototype}else d.prototype=c,d.prototype.constructor=b,d.prototype.base=c;for(var f in b)if(b.hasOwnProperty(f)){var g=d.prototype[f];d.prototype[f]=b[f],g instanceof Function&&(d.prototype[f].baseImplementation=g)}return d.prototype.callBase=inherit.callBase,d},inherit.callBase=function(){var a=Array.prototype.slice.call(arguments);return a.length==0&&(a=Array.prototype.slice.call(arguments.callee.caller.arguments)),arguments.callee.caller.baseImplementation.apply(this,a)},Function.prototype.inherit=function(a,b){return arguments.length==1?inherit(a,this):inherit(a,b,this)},Function.prototype.callBase=function(){var a=Array.prototype.slice.call(arguments),b=a.shift();if(b&&b.base){var c=arguments.callee.caller;return this==c?this.baseImplementation.apply(b,a):this.apply(b,a)}throw"base not definied"},inherit.Base=inherit({ctor:function(){}}),b.inherit=inherit})(this,typeof exports=="undefined"?this:exports),define("inherit",function(){return inherit}),define("inherit",function(){}),define("js/core/Base",["inherit"],function(a){return a.Base.inherit({ctor:function(){},runsInBrowser:function(){return typeof window!="undefined"}})}),define("js/core/EventDispatcher",["js/core/Base"],function(a){Function.prototype.on=function(){var a=Array.prototype.slice.call(arguments,0);this._events=this._events||[];for(var b=0;b<a.length;b++){var c=a[b];this._events.push(c)}return this},Function.prototype.onChange=function(){var a=Array.prototype.slice.call(arguments,0);this._events=this._events||[];for(var b=0;b<a.length;b++){var c=a[b];c="change:"+c,this._events.push(c)}return this};var b,c=a.inherit("js.core.EventDispatcher",{ctor:function(){this.callBase(),this._eventHandlers={}},bind:function(a,b,d){d=d||this;var e=this._eventHandlers[a]||(this._eventHandlers[a]=[]);return e.push(new c.EventHandler(b,d)),this},trigger:function(a,d,e){if(this._eventHandlers[a]){d instanceof c.Event||(d=new c.Event(d)),e||(e=arguments.callee.caller),d.type=a;var f=this._eventHandlers[a];for(var g=0;g<f.length;g++)if(f[g]){var h=f[g].trigger(d,e);h!==b&&(ret=h,h===!1&&(d.preventDefault(),d.stopPropagation()));if(d.isImmediatePropagationStopped)break}}return d},unbind:function(a,b){if(!a)this._eventHandlers={};else if(!b)this._eventHandlers[a]=[];else if(this._eventHandlers[a]){var c=this._eventHandlers[a];for(var d=c.length-1;d>=0;d--)c[d].$callback==b&&c.splice(d,1)}}});return c.Event=a.inherit({ctor:function(a){this.$=a,this.isDefaultPrevented=!1,this.isPropagationStopped=!1,this.isImmediatePropagationStopped=!1},preventDefault:function(){this.isDefaultPrevented=!0;var a=this.orginalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=!0;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=!0,this.stopPropagation()}}),c.EventHandler=a.inherit({ctor:function(a,b){this.scope=b,this.$callback=a},trigger:function(a,b){this.$callback.call(this.scope,a,b)}}),c}),function(){function a(b,c,d){if(b===c)return b!==0||1/b==1/c;if(b==null||c==null)return b===c;b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped);if(b.isEqual&&v.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&v.isFunction(c.isEqual))return c.isEqual(b);var e=i.call(b);if(e!=i.call(c))return!1;switch(e){case"[object String]":return b==String(c);case"[object Number]":return b!=+b?c!=+c:b==0?1/b==1/c:b==+c;case"[object Date]":case"[object Boolean]":return+b==+c;case"[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if(typeof b!="object"||typeof c!="object")return!1;for(var f=d.length;f--;)if(d[f]==b)return!0;d.push(b);var f=0,g=!0;if(e=="[object Array]"){if(f=b.length,g=f==c.length)for(;f--;)if(!(g=f in b==f in c&&a(b[f],c[f],d)))break}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var h in b)if(v.has(b,h)&&(f++,!(g=v.has(c,h)&&a(b[h],c[h],d))))break;if(g){for(h in c)if(v.has(c,h)&&!(f--))break;g=!f}}return d.pop(),g}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=e.slice,h=e.unshift,i=f.toString,j=f.hasOwnProperty,k=e.forEach,l=e.map,m=e.reduce,n=e.reduceRight,o=e.filter,p=e.every,q=e.some,r=e.indexOf,s=e.lastIndexOf,f=Array.isArray,t=Object.keys,u=Function.prototype.bind,v=function(a){return new C(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=v),exports._=v):b._=v,v.VERSION="1.3.1";var w=v.each=v.forEach=function(a,b,c){if(a!=null)if(k&&a.forEach===k)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)break}else for(e in a)if(v.has(a,e)&&b.call(c,a[e],e,a)===d)break};v.map=v.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(w(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},v.reduce=v.foldl=v.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=v.bind(b,d)),e?a.reduce(b,c):a.reduce(b);w(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},v.reduceRight=v.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=v.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=v.toArray(a).reverse();return d&&!e&&(b=v.bind(b,d)),e?v.reduce(f,b,c,d):v.reduce(f,b)},v.find=v.detect=function(a,b,c){var d;return x(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},v.filter=v.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(w(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},v.reject=function(a,b,c){var d=[];return a==null?d:(w(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},v.every=v.all=function(a,b,c){var e=!0;return a==null?e:p&&a.every===p?a.every(b,c):(w(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),e)};var x=v.some=v.any=function(a,b,c){b||(b=v.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,c):(w(a,function(a,f,g){if(e||(e=b.call(c,a,f,g)))return d}),!!e)};v.include=v.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:c=x(a,function(a){return a===b})},v.invoke=function(a,b){var c=g.call(arguments,2);return v.map(a,function(a){return(v.isFunction(b)?b||a:a[b]).apply(a,c)})},v.pluck=function(a,b){return v.map(a,function(a){return a[b]})},v.max=function(a,b,c){if(!b&&v.isArray(a))return Math.max.apply(Math,a);if(!b&&v.isEmpty(a))return-Infinity;var d={computed:-Infinity};return w(a,function(a,e,f){e=b?b.call(c,a,e,f):a,e>=d.computed&&(d={value:a,computed:e})}),d.value},v.min=function(a,b,c){if(!b&&v.isArray(a))return Math.min.apply(Math,a);if(!b&&v.isEmpty(a))return Infinity;var d={computed:Infinity};return w(a,function(a,e,f){e=b?b.call(c,a,e,f):a,e<d.computed&&(d={value:a,computed:e})}),d.value},v.shuffle=function(a){var b=[],c;return w(a,function(a,d){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},v.sortBy=function(a,b,c){return v.pluck(v.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},v.groupBy=function(a,b){var c={},d=v.isFunction(b)?b:function(a){return a[b]};return w(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},v.sortedIndex=function(a,b,c){c||(c=v.identity);for(var d=0,e=a.length;d<e;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},v.toArray=function(a){return a?a.toArray?a.toArray():v.isArray(a)?g.call(a):v.isArguments(a)?g.call(a):v.values(a):[]},v.size=function(a){return v.toArray(a).length},v.first=v.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},v.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},v.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},v.rest=v.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},v.compact=function(a){return v.filter(a,function(a){return!!a})},v.flatten=function(a,b){return v.reduce(a,function(a,c){return v.isArray(c)?a.concat(b?c:v.flatten(c)):(a[a.length]=c,a)},[])},v.without=function(a){return v.difference(a,g.call(arguments,1))},v.uniq=v.unique=function(a,b,c){var c=c?v.map(a,c):a,d=[];return v.reduce(c,function(c,e,f){if(0==f||(b===!0?v.last(c)!=e:!v.include(c,e)))c[c.length]=e,d[d.length]=a[f];return c},[]),d},v.union=function(){return v.uniq(v.flatten(arguments,!0))},v.intersection=v.intersect=function(a){var b=g.call(arguments,1);return v.filter(v.uniq(a),function(a){return v.every(b,function(b){return v.indexOf(b,a)>=0})})},v.difference=function(a){var b=v.flatten(g.call(arguments,1));return v.filter(a,function(a){return!v.include(b,a)})},v.zip=function(){for(var a=g.call(arguments),b=v.max(v.pluck(a,"length")),c=Array(b),d=0;d<b;d++)c[d]=v.pluck(a,""+d);return c},v.indexOf=function(a,b,c){if(a==null)return-1;var d;if(c)return c=v.sortedIndex(a,b),a[c]===b?c:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(c=0,d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1},v.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1},v.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};var y=function(){};v.bind=function(a,b){var c,d;if(a.bind===u&&u)return u.apply(a,g.call(arguments,1));if(!v.isFunction(a))throw new TypeError;return d=g.call(arguments,2),c=function(){if(this instanceof c){y.prototype=a.prototype;var e=new y,f=a.apply(e,d.concat(g.call(arguments)));return Object(f)===f?f:e}return a.apply(b,d.concat(g.call(arguments)))}},v.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=v.functions(a)),w(b,function(b){a[b]=v.bind(a[b],a)}),a},v.memoize=function(a,b){var c={};return b||(b=v.identity),function(){var d=b.apply(this,arguments);return v.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},v.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},v.defer=function(a){return v.delay.apply(v,[a,1].concat(g.call(arguments,1)))},v.throttle=function(a,b){var c,d,e,f,g,h=v.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i;e||(e=setTimeout(function(){e=null,g&&a.apply(c,d),h()},b)),f?g=!0:a.apply(c,d),h(),f=!0}},v.debounce=function(a,b){var c;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){c=null,a.apply(d,e)},b)}},v.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},v.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},v.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},v.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},v.keys=t||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)v.has(a,c)&&(b[b.length]=c);return b},v.values=function(a){return v.map(a,v.identity)},v.functions=v.methods=function(a){var b=[],c;for(c in a)v.isFunction(a[c])&&b.push(c);return b.sort()},v.extend=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},v.defaults=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a},v.tap=function(a,b){return b(a),a},v.isEqual=function(b,c){return a(b,c,[])},v.isEmpty=function(a){if(v.isArray(a)||v.isString(a))return a.length===0;for(var b in a)if(v.has(a,b))return!1;return!0},v.isElement=function(a){return!!a&&a.nodeType==1},v.isArray=f||function(a){return i.call(a)=="[object Array]"},v.isObject=function(a){return a===Object(a)},v.isArguments=function(a){return i.call(a)=="[object Arguments]"},v.isArguments(arguments)||(v.isArguments=function(a){return!!a&&!!v.has(a,"callee")}),v.isFunction=function(a){return i.call(a)=="[object Function]"},v.isString=function(a){return i.call(a)=="[object String]"},v.isNumber=function(a){return i.call(a)=="[object Number]"},v.isNaN=function(a){return a!==a},v.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},v.isDate=function(a){return i.call(a)=="[object Date]"},v.isRegExp=function(a){return i.call(a)=="[object RegExp]"},v.isNull=function(a){return a===null},v.isUndefined=function(a){return a===void 0},v.has=function(a,b){return j.call(a,b)},v.noConflict=function(){return b._=c,this},v.identity=function(a){return a},v.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},v.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},v.mixin=function(a){w(v.functions(a),function(b){E(b,v[b]=a[b])})};var z=0;v.uniqueId=function(a){var b=z++;return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/.^/,B=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};v.template=function(a,b){var c=v.templateSettings,c="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||A,function(a,b){return"',_.escape("+B(b)+"),'"}).replace(c.interpolate||A,function(a,b){return"',"+B(b)+",'"}).replace(c.evaluate||A,function(a,b){return"');"+B(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj","_",c);return b?d(b,v):function(a){return d.call(this,a,v)}},v.chain=function(a){return v(a).chain()};var C=function(a){this._wrapped=a};v.prototype=C.prototype;var D=function(a,b){return b?v(a).chain():a},E=function(a,b){C.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),D(b.apply(v,a),this._chain)}};v.mixin(v),w("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=e[a];C.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],D(c,this._chain)}}),w(["concat","join","slice"],function(a){var b=e[a];C.prototype[a]=function(){return D(b.apply(this._wrapped,arguments),this._chain)}}),C.prototype.chain=function(){return this._chain=!0,this},C.prototype.value=function(){return this._wrapped}}.call(this),define("underscore",function(){return _}),define("underscore",function(){}),define("js/core/Bindable",["js/core/EventDispatcher","underscore"],function(a,b){var c=a.inherit("js.core.EventDispatcher",{ctor:function(a){this.callBase(null),this.$={},b.extend(this._eventAttributes,this.base._eventAttributes||{}),a=a||{},b.defaults(a,this._defaultAttributes()),this.$=a,this.$previousAttributes=b.clone(a);var c=this,d,e=function(a,b,d){c.bind("change:"+a,function(){c.set(b,d.call(c))})}},defaults:{},_defaultAttributes:function(){return this._generateDefaultsChain("defaults")},_generateDefaultsChain:function(a){var c=this[a],d=this.base;while(d)b.defaults(c,d[a]),d=d.base;for(var e in c)c.hasOwnProperty(e)&&!b.isFunction(c[e])&&(c[e]=b.clone(c[e]));return c},set:function(a,c,d){var e={};if(b.isString(a)){var f=a.split(".");if(f.length>1){var g=this.get(f.shift());if(g&&g.set)return g.set(f.join("."),c,d),this}e[a]=c}else d=c,e=a;d=d||{silent:!1,unset:!1};if(d.unset)for(a in e)e[a]=void 0;var h={},i=!0,j=this.$,k;for(a in e)e.hasOwnProperty(a)&&(k=e[a],d.unset===!0?delete j[a]:b.isEqual(j[a],e[a])||(this.$previousAttributes[a]=j[a],j[a]=e[a],h[a]=j[a]));this._commitChangedAttributes(h);if(d.silent===!1&&b.size(h)>0){for(a in h)h.hasOwnProperty(a)&&this.trigger("change:"+a,h[a],this);this.trigger("change",h,this)}return this},get:function(a){return this.$[a]},has:function(a){return typeof this.$[a]!="undefined"&&this.$[a]!==null},_commitChangedAttributes:function(a){},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(){return this.set(this.$,{unset:!0})}});return c.StringParser={$fncRegEx:/^([a-z$_]\w*)\((.*)\)$/i,splitPathOutSide:function(a,b,c,d){var e=0,f=[],g,h,i,j=0;for(var k=0;k<a.length-1;k++)g=a.charAt(k),h=a.substr(k,c.length),i=a.substr(k,d.length),h==c&&e++,i==d&&e--,e===0&&b==g&&(f.push(a.substring(j,k)),j=k+1);return j>0?(f.push(a.substr(j)),f):[a]},splitFirst:function(a,b,c,d){return this.splitPathOutSide(a,b,c,d)[0]},findMatchesIn:function(a,c,d,e){if(!b.isString(a))return[];var f,g,h=[],i,j=[],k;for(var l=0;l<a.length;l++)f=a.substr(l,c.length),g=a.substr(l,d.length),f==c?h.push(l):g==d&&h.length>0&&(k=h.pop(),h.length==e&&(i=a.substring(k,l+1),j.push(i),f=g=null));return j},isFunctionDefinition:function(a){return this.findMatchesIn(a,"(",")",0).length>0},getFunctionInfo:function(a){var b=a.match(Parser.$fncRegEx);return{name:b[1],parameters:this.splitPathOutSide(b[2],",","(",")")}},extract:function(a,b,c){var d=a.indexOf(b),e=a.lastIndexOf(c);return d<e?a.substring(d+b.length,e):null}},c}),define("js/core/Element",["js/core/Bindable","underscore"],function(a,b){function d(a){if(b.isString(a)){var c=parseFloat(a);if(!b.isNaN(c))return c;if(a==="true")return!0;if(a==="false")return!1}return a}var c,e=a.inherit("js.core.Element",{ctor:function(a,d,e,f,g){a=a||{},d||g||(g=this),this.$descriptor=d,this.$systemManager=e,this.$parentScope=f||null,this.$rootScope=g||null,b.extend(a,this._getAttributesFromDescriptor(d),this._getAttributesFromDescriptor(this._$descriptor)),this.callBase(a),this._initializeAttributes(this.$),(d===c||d===null)&&this._initialize(this.$creationPolicy)},_getAttributesFromDescriptor:function(a){var b={};if(a&&a.attributes){var c;for(var e=0;e<a.attributes.length;e++)c=a.attributes[e],b[c.nodeName]=d(c.value)}return b},defaults:{creationPolicy:"auto"},_initializeAttributes:function(a){},_initializeDescriptors:function(){},_initialize:function(a,b){if(this.$initialized)return;this._preinitialize(),this.initialize(),this._initializeDescriptors(),(this==this.$rootScope||b)&&this._initializeBindings()},_initializeBindings:function(){this._initializationComplete()},_initializeDescriptor:function(a){},initialize:function(){},find:function(a){var b=this.getScopeForKey(a);return this==b?this.callBase():b!=null?b.get(a):null},getScopeForKey:function(a){var c=this.$[a];return b.isUndefined(c)?this.$parentScope?this.$parentScope.getScopeForKey(a):null:this},getScopeForFncName:function(a){var c=this[a];return!b.isUndefined(c)&&b.isFunction(c)?this:this.$parentScope?this.$parentScope.getScopeForFncName(a):null},_preinitialize:function(){},_initializationComplete:function(){this.$initialized=!0},_getTextContentFromDescriptor:function(a){var b=a.textContent||a.text||a.data;if(!b){b="";for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType==1||d.nodeType==4)b+=this._getTextContentFromDescriptor(d)}}return b}});return e.xmlStringToDom=function(a){if(window&&window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml").documentElement;if(typeof ActiveXObject!="undefined"){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async=!1,b.loadXML(a),b.documentElement}throw"Couldn't parse xml string"},e}),define("js/core/Binding",["js/core/Bindable","js/core/EventDispatcher","js/core/BindingParser","underscore"],function(a,b,c,d){var e=function(a){var b="",c;for(var d=0;d<a.length;d++)c=a[d],b+=c instanceof Object?c.toString():c;return b},f=function(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];if(d.type!="var")return!1;b.push(d.name)}return b.join(".")},g=a.inherit("js.core.Binding",{defaults:{event:"change",path:null,twoWay:!1,transform:function(a){return a},transformBack:function(a){return a}},ctor:function(){this.callBase(),this.initialize()},initialize:function(){this._checkAttributes(),this.$parameters=[],this.$subBinding=null,this.$.rootScope||(this.$.rootScope=this);var a=this.$.scope;this.$.key=this.$.path[0];if(this.$.key.type=="fnc"){var b=this.$.key.name;this.$parameters=this.$.key.parameter;if(d.isFunction(a[b])){var c=a[b],e=[];c._events?e=c._events:e=["change"];for(var f=0;f<e.length;f++){var h=e[f];a.bind(h,this._callback,this)}var i=this,j=function(){i.trigger()},k;for(var l=0;l<this.$parameters.length;l++)k=this.$parameters[l],d.isObject(k)&&(this.$parameters[l]=g.create(k,this.$.target,j));this.$.fnc=c,this.$.fnc.trigger=this.trigger}}else this.$.event="change:"+this.$.key.name,a.bind(this.$.event,this._callback,this),this.$.twoWay===!0&&(this.$.targetEvent="change:"+this.$.targetKey,this.$.target.bind(this.$.targetEvent,this._revCallback,this));this._createSubBinding()},_checkAttributes:function(){if(!this.$.path)throw"No path defined!";if(!this.$.scope)throw"No scope defined!";if(this.$.twoWay){if(!this.$.target)throw"TwoWay binding, but no target defined!";if(!this.$.target instanceof a)throw"Target is not a Bindable!";if(!this.$.targetKey)throw"TwoWay binding, but no target key defined!"}},_createSubBinding:function(){if(this.$.path.length>1){var a;this.$.fnc?a=this.getValue():a=this.$.scope.$[this.$.key.name],a&&a instanceof b&&(this.$subBinding=new g({scope:a,path:this.$.path.slice(1),target:this.$.target,targetKey:this.$.targetKey,rootScope:this.$.rootScope,callback:this.$.callback,context:this.$.context}))}},_revCallback:function(a){this.$.scope.set(f(this.$.path),this.$.transformBack(a.$,this.$.target))},_callback:function(){this.$subBinding&&(this.$subBinding.destroy(),this.$subBinding=null),this._createSubBinding(),this.trigger()},destroy:function(){this.$.scope.unbind(this.$.event,this._callback),this.$.twoWay===!0&&this.$.target.unbind(this.$.targetEvent,this._revCallback),this.$subBinding&&this.$subBinding.destroy();for(var a=0;a<this.$parameters.length;a++){var b=this.$parameters[a];b instanceof g&&b.destroy()}},getValue:function(){if(this.$subBinding)return this.$subBinding.getValue();if(this.$.fnc){var a=[];for(var b=0;b<this.$parameters.length;b++){var c=this.$parameters[b];c instanceof g&&(c=c.getValue()),a.push(c)}return this.$.fnc.apply(this.$.scope,a)}return this.$.path.length==1?this.$.scope.get(this.$.key.name):null},getContextValue:function(){return this.$.context&&this.$.context.length>1?e(this.$.context):this.getValue()},trigger:function(){var a=this.getContextValue();this.$.targetKey?this.$.target.set(this.$.targetKey,this.$.transform(a,this.$.rootScope)):this.$.callback&&this.$.callback.call(this.$.target,this.$.transform(a,this.$.rootScope))},toString:function(){return this.getValue()}});return g.create=function(a,b,c,e){var f=a.path,h=f[0],i,j=b;c==h.name&&(j=j.$parentScope),h.type=="fnc"?i=j.getScopeForFncName(h.name):i=j.getScopeForKey(h.name);if(a.type=="static"){var k=i;while(k&&f.length>0){h=f.shift();if(h.type=="fnc"){var l=i[h.name],m=h.parameters;for(var n=0;n<m.length;n++){var o=m[n];if(d.isObject(o)){o.type="static";var p=g.create(o,i,"",e);p instanceof g?m[n]=p.getValue():m[n]=p}}k=l.apply(this,m)}else if(h.type="var")k=k.get(h.name)}return k}var q;d.isFunction(c)&&(q=c);if(i){var r=a.type=="twoWay",s={scope:i,path:f,target:b,twoWay:r,context:e};return q?s.callback=q:s.targetKey=c,new g(s)}},g.evaluateText=function(a,b,f){if(!d.isString(a))return a;var h=c.parse(a,"text"),i,j=[];for(var k=0;k<h.length;k++){var l=h[k];l.length?h[k]=l:(i=g.create(l,b,f,h),i instanceof g&&j.push(i),h[k]=i)}return j.length>0?j[0].getContextValue():h.length>0?e(h):a},g}),define("js/core/TextElement",["js/core/Element","js/core/Binding","underscore"],function(a,b,c){return a.inherit("js.core.TextElement",{_initializeBindings:function(){if(this.$descriptor){var a=this._getTextContentFromDescriptor(this.$descriptor);this.$.textContent=b.evaluateText(a,this,"textContent")}},render:function(){return this.$initialized||this._initialize(this.$creationPolicy),this.$el=this.$systemManager.$document.createTextNode(""),c.isUndefined(this.$.textContent)||this._renderTextContent(this.$.textContent),this.$el},_renderTextContent:function(a){this.$el.data=a},_commitChangedAttributes:function(a){this.$el&&(c.isUndefined(a.textContent)||this._renderTextContent(a.textContent))}})}),define("js/core/Component",["require","js/core/Element","js/core/TextElement","js/core/Binding","underscore"],function(a,b,c,d,e){var f,g,h=b.inherit("js.core.Component",{ctor:function(b,c,d,h,i){if(e.isUndefined(f))try{f=a("js/core/Template")}catch(j){f=null}if(e.isUndefined(g))try{g=a("js/conf/Configuration")}catch(j){g=null}this.$components=[],this.$templates={},this.$configurations=[],this.$children=[],this.callBase()},events:["ontest"],inject:{},_injectChain:function(){return this._generateDefaultsChain("inject")},_preinitialize:function(){this.callBase(),this._inject()},_inject:function(){var a=this._injectChain();if(e.keys(a).length>0){var b=this.$systemManager.$injection;if(!b)throw"injection not available in systemManager";for(var c in a)a.hasOwnProperty(c)&&(this.$[c]=b.getInstance(a[c]))}},addComponent:function(a){if(!a)throw"component null";this.$components.push(a),this.$rootScope&&a.$.cid&&this.$rootScope.set(a.$.cid,a)},removeComponent:function(a){},addChild:function(a){if(!(a instanceof b))throw"only children of type js.core.Component can be added";this.addComponent(a),a.$parent=this,this.$children.push(a)},removeChild:function(a){if(!(a instanceof b))throw"only children of type js.core.Component can be removed";var c=this.$children.indexOf(a);c!=-1&&(a.$parent=null,this.$children.splice(c,1)),this.$templates.hasOwnProperty(a.$.name)&&delete this.$templates[a.$.name],c=this.$children.indexOf(a),c!=-1&&this.$configurations.splice(c,1)},addTemplate:function(a){if(!a.$.name)throw"template without name";this.addComponent(a),this.$templates[a.$.name]=a},addConfiguration:function(a){this.addComponent(a),this.$configurations.push(a)},getTemplate:function(a){var b=this.$templates[a];return b?b:this.$parent&&this.$parent!=this?this.$parent.getTemplate(a):null},_initializeChildren:function(a){for(var b=0;b<a.length;b++){var c=a[b];f&&c instanceof f?this.addTemplate(c):g&&c instanceof g?this.addConfiguration(c):this.addChild(a[b]),this.$creationPolicy=="auto"&&c._initialize(this.$creationPolicy)}},_initializeAttributes:function(a){this.callBase(),this.$creationPolicy!="full"&&a.hasOwnProperty("creationPolicy")&&(this.$creationPolicy=a.creationPolicy,delete a.creationPolicy)},_initializeDescriptors:function(){var a=[],b=[],c=this;while(c)c._$descriptor&&b.unshift(c._$descriptor),c=c.base;this.$descriptor&&b.push(this.$descriptor);var d,e,f;for(var g=0;g<b.length;g++)d=b[g],this._cleanUpDescriptor(d),a=a.concat(this._getChildrenFromDescriptor(d));this._initializeChildren(a),this._childrenInitialized()},_cleanUpDescriptor:function(a){if(a&&a.childNodes){var b,c;for(var d=a.childNodes.length-1;d>=0;d--)b=a.childNodes[d],b.nodeType===3&&(c=b.textContent||b.text||b.data,(!c||c.trim().length===0)&&a.removeChild(b))}else console.warn("Descriptor not defined or not correct")},_isEventAttribute:function(a){return a.indexOf("on")==0},_isComponentEvent:function(a){for(var b=0;b<this.events.length;b++)if(a==this.events[b])return!0;return!1},_getEventTypeForAttribute:function(a){return this._eventAttributes[a]},_initializeBindings:function(){this.$bindings=[],this.$eventDefinitions=[];var a=this.$,b=this,c,e,f;for(var g in a)if(a.hasOwnProperty(g)){var h=a[g];if(this._isEventAttribute(g)){if(!this.$rootScope[h])throw"Couldn't find callback "+h+" for "+g+" event";this.$eventDefinitions.push({name:g,scope:this.$rootScope,fncName:h}),this._isComponentEvent(g.substr(2))&&this.bind(g,this.$rootScope[h],this.$rootScope),delete a[g]}else this.$[g]=d.evaluateText(h,this,g)}for(var i=0;i<this.$components.length;i++)this.$components[i]._initializeBindings();this.callBase()},_createComponentForNode:function(a,b){if(!a)return null;b=b||{};var c=this.$systemManager.$applicationDomain;if(a.nodeType==1){var d=this.$systemManager.$applicationContext.getFqClassName(a.namespaceURI,this._localNameFromDomNode(a),!0),e=this.$systemManager.$applicationContext.getFqClassName(a.namespaceURI,this._localNameFromDomNode(a),!1);return this.$systemManager.$applicationContext.createInstance(d,[b,a,this.$systemManager,this,this.$rootScope],e)}if(a.nodeType==3){var f=a.textContent?a.textContent:a.text;return a.textContent&&(a.textContent=f),this.$systemManager.$applicationContext.createInstance("js/core/TextElement",[null,a,this.$systemManager,this,this.$rootScope])}return null},_getChildrenFromDescriptor:function(a){var b=[],c,d;if(a)for(var e=0;e<a.childNodes.length;e++)c=a.childNodes[e],d=this._createComponentForNode(c),d&&b.push(d);return b},_childrenInitialized:function(){},initialize:function(a){},_localNameFromDomNode:function(a){if(a.localName)return a.localName;var b=a.tagName.split(":");return b[b.length-1]}});return h}),define("js/core/Content",["js/core/Component"],function(a){return a.inherit("js.core.Content",{})}),define("js/html/DomElement",["require","js/core/Component","js/core/Content","js/core/Binding","inherit","underscore"],function(a,b,c,d,e,f){var g=/\s+/,h=["click","dblclick","keyup","keydown","change"],i;a(["js/ui/ContentPlaceHolder"],function(a){i=a});var j={defaults:{selected:undefined,selectable:undefined},$classAttributes:[],$behavesAsDomElement:!0,ctor:function(a,b,c,d,e){this.$renderMap={},this.$childViews=[],this.$contentChildren=[],this.callBase(),b&&(this.$tagName||(this.$tagName=b.tagName),this.$namespace||(this.$namespace=b.namespaceURI))},_initializeAttributes:function(a){this.callBase(),a.tagName&&(this.$tagName=a.tagName,delete a.tagName)},addChild:function(a){this.callBase(),a instanceof m||a.render?(this.$childViews.push(a),this.isRendered()&&this._renderChild(a)):a instanceof c&&this.$contentChildren.push(a)},getPlaceHolder:function(a){for(var b=0;b<this.$children.length;b++)if(this.$children[b].$.name===a)return this.$children[b];var c;for(b=0;b<this.$children.length;b++)if(this.$children[b].getPlaceHolder){c=this.$children[b].getPlaceHolder(a);if(c)return c}return null},getContentPlaceHolders:function(){var a=[],b;for(var c=0;c<this.$children.length;c++)b=this.$children[c],i&&b instanceof i?a.push(b):b instanceof m&&(a=a.concat(b.getContentPlaceHolders()));return a},findContent:function(a){var b,d;for(var e=0;e<this.$children.length;e++){b=this.$children[e];if(b instanceof c&&b.$.name===a)return b}for(e=0;e<this.$children.length;e++){b=this.$children[e];if(b.findContent){d=b.findContent(a);if(d)return d}}return null},render:function(){return this.$initialized||this._initialize(this.$creationPolicy),this.isRendered()?this.$el:(this.$renderedChildren=[],this.$el=this.$systemManager.$document.createElement(this.$tagName),this.$el.owner=this,this._renderChildren(this.$childViews),this._renderContentChildren(this.$contentChildren),this._renderAttributes(this.$),this._bindDomEvents(this.$el),this.$el)},_bindDomEvents:function(a){function d(a,d,e){b.bind(a,d[e],d),c=a.substr(2),b.addEventListener(c,function(c){b.trigger(a,c,b)})}var b=this,c,e;for(var f=0;f<this.$eventDefinitions.length;f++)e=this.$eventDefinitions[f],this._isComponentEvent(e.name.substr(2))||d(e.name,e.scope,e.fncName)},_renderChildren:function(a){var b;for(var c=0;c<a.length;c++)b=a[c],this._renderChild(b)},_renderContentChildren:function(a){var b;for(var c=0;c<a.length;c++){b=a[c];var d=b.get("ref"),e=this.getPlaceHolder(d);e&&e.set({content:b})}},_renderChild:function(a){if(f.isFunction(a.render)){var b=a.render();this.$renderedChildren.push(a),b&&this.$el.appendChild(b)}},_removeRenderedChild:function(a){if(this.isRendered()){var b;for(var c=this.$renderedChildren.length-1;c>=0;c--){b=this.$renderedChildren[c];if(a===b){this.$el.removeChild(b.$el),this.$renderedChildren.splice(c,1);return}}}},_clearRenderedChildren:function(){if(this.isRendered()){var a;for(var b=this.$renderedChildren.length-1;b>=0;b--)a=this.$renderedChildren[b],this.$el.removeChild(a.$el)}this.$renderedChildren=[]},_getIndexOfPlaceHolder:function(a){if(this.$layoutTpl){var b;for(var c=0;c<this.$layoutTpl.$children.length;c++){b=this.$layoutTpl.$children[c];if(placeHolderId==b.$cid)return c}}return-1},isRendered:function(){return typeof this.$el!="undefined"},_renderAttributes:function(a){var b;for(var c in a)a.hasOwnProperty(c)&&c.indexOf("$")!==0&&c.indexOf("data")!==0&&(b=a[c],this._renderAttribute(c,b))},_renderAttribute:function(a,b){if(f.contains(this.$classAttributes,a))return;var c=this.$renderMap[a],d=this.$previousAttributes[a];if(f.isUndefined(c)){var e=a[0].toUpperCase()+a.substr(1),g="_render"+e;c=this[g],f.isFunction(c)||(c=!1),this.$renderMap[a]=c}c!==!1?c.call(this,b,d):this.$behavesAsDomElement&&!f.isUndefined(b)&&this.$el.setAttribute(a,b)},_renderVisible:function(a){a===!0?this.removeClass("hidden"):a===!1&&this.addClass("hidden")},_renderHidden:function(a){typeof a!="undefined"&&this.set({visible:!a})},_renderSelected:function(a){a===!0?this.addClass("active"):a===!1&&this.removeClass("active")},_renderSelectable:function(a){if(a===!0){var b=this;this.addEventListener("click",function(a){b.set({selected:!b.$.selected})})}else this.set({selected:!1})},_renderWidth:function(a){a&&(typeof a!="string"&&(a+="px"),this.$el.style.width=a)},_renderHeight:function(a){a&&(typeof a!="string"&&(a+="px"),this.$el.style.height=a)},_commitChangedAttributes:function(a){this.isRendered()&&this._renderAttributes(a)},html:function(){return this.isRendered()||this.render(),this.$el.innerHTML}.on("change"),dom:function(a){return new l(a||this)}},k={hasClass:function(a){},addClass:function(a){var b=a.split(g);if(!this.$el.className&&b.length===1)this.$el.className=a;else{var c=this.$el.className.split(g);for(var d=0;d<b.length;d++)c.indexOf(b[d])==-1&&c.push(b[d]);this.$el.className=c.join(" ")}},removeClass:function(a){if(this.$el.className.length===0)return;var b=a.split(g),c=this.$el.className.split(g);for(var d=0;d<b.length;d++){var e=c.indexOf(b[d]);e!=-1&&c.splice(e,1)}c.length===0?this.$el.removeAttribute("class"):this.$el.className=c.join(" ")},addEventListener:function(a,b){this.$el.addEventListener?this.$el.addEventListener(a,b,!1):this.$el.attachEvent&&this.$el.attachEvent("on"+a,b)},removeEvent:function(a,b){this.$el.removeEventListener?this.$el.removeEventListener(a,b,!1):this.$el.detachEvent&&this.$el.detachEvent("on"+a,b)}},l=e.Base.inherit(f.extend({ctor:function(a){this.$el=a}},k)),m=b.inherit("js.html.DomElement",f.extend(j,k));return m}),define("js/core/UIComponent",["js/html/DomElement"],function(a){return a.inherit("js.core.UIComponent",{defaults:{tagName:"div"},$behavesAsDomElement:!1})}),define("js/core/History",["js/core/Bindable"],function(a){var b=/^#\/?/,c,d=function(){};return a.inherit("js.core.History",{ctor:function(){this.callBase(),this.$routers=[],this.processUrl=!0,this.$history=[]},defaults:{interval:50},getFragment:function(){var a;return this.runsInBrowser()?a=decodeURIComponent(window.location.hash):a=this.$history[this.$history.length-1]||"",a.replace(b,"")},start:function(a,b){var c=this;this.$checkUrlFn=function(){c.checkUrl.apply(c,arguments)},this.runsInBrowser()?"onhashchange"in window?window.addEventListener?window.addEventListener("hashchange",this.$checkUrlFn,!1):window.attachEvent("onhashchange",this.$checkUrlFn):this.$checkUrlInterval=setInterval(this.$checkUrlFn,this.$.interval):this.$history.push(b||""),this.fragment=this.getFragment(),this.navigate(this.fragment,!0,!0,a),this.processUrl=!0},stop:function(){typeof window!="undefined"&&("onhashchange"in window?window.removeEventListener?window.removeEventListener("hashchange",this.$checkUrlFn,!1):window.detachEvent("onhashchange",this.$checkUrlFn):clearInterval(this.$checkUrlInterval))},addRouter:function(a){this.$routers.unshift(a)},checkUrl:function(a){if(this.processUrl){var b=this.getFragment();if(b==this.fragment)return!1;this.navigate(b,!0,!0,d)}this.processUrl=!0},triggerRoute:function(a,b){for(var c=0;c<this.$routers.length;c++)if(this.$routers[c].executeRoute(a,b))return!0;console.log("no route for '"+a+"' found.")},navigate:function(a,b,d,e){!e&&b instanceof Function&&(e=b,b=null),!e&&d instanceof Function&&(e=d,d=null);if(b==c||b==null)b=!0;if(d==c||d==null)d=!0;this.processUrl=!1,b?this.runsInBrowser()?window.location.hash="/"+a:(this.$history.push(a),this.checkUrl(null)):this.runsInBrowser()?window.location.replace("#/"+a):this.$history[this.$history.length-1]=a,this.fragment=a;var f;d&&(f=this.triggerRoute(a,e)),!f&&e&&e()}})}),define("js/core/Application",["js/core/UIComponent","js/core/History"],function(a,b){return a.inherit("js.core.Application",{ctor:function(){this.history=new b,this.callBase()},initialize:function(){this.callBase()},_inject:function(){},_initializeDescriptors:function(){this.callBase(),a.prototype._inject.call(this)},start:function(a,b){a=a||{},this.history.start(b,a.initialHash)},render:function(a){var b=this.callBase(null);return a&&a.appendChild(b),b},toString:function(){return"js.core.Application"}})}),define("js/core/List",["js/core/Bindable","underscore"],function(a,b){return a.inherit("js.core.List",{ctor:function(a,b){this.$items=[],this.callBase(this,b),a&&this.add(a);var c=this;this.bind("add",function(){c.length=c.size()}),this.bind("remove",function(){c.length=c.size()}),this.length=this.size()},hasItems:function(){return this.$items.length>0}.on("add","remove"),push:function(a){this.$items.push(a),this.trigger("add",{item:a,index:this.$items.length-1})},pop:function(){return this.removeAt(this.$items.length)},shift:function(){return this.removeAt(0)},unshift:function(a){this.$items.unshift(a),this.trigger("add",{item:a,index:0})},add:function(c,d){d=d||{},b.defaults(d,{silent:!1,index:this.$items.length});var e=d.index;b.isArray(c)||(c=[c]);var f,g;for(var h=0;h<c.length;h++)f=c[h],f instanceof a&&f.bind("change",this._onItemChange,this),g=e+h,this.$items.splice(g,0,f),d.silent!==!0&&this.trigger("add",{item:f,index:g})},_onItemChange:function(a,b){this.trigger("change",{item:b,index:this.$items.indexOf(b)})},remove:function(a,c){b.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++)this.removeAt(this.$items.indexOf(a[d]),c)},removeAt:function(a,b){b=b||{};if(a>-1&&a<this.$items.length){var c=this.$items.splice(a,1);return b.silent!==!0&&this.trigger("remove",{item:c[0],index:a}),c[0]}return null},reset:function(a){this.$items=a,this.trigger("reset",{items:a})},sort:function(a){this.trigger("sort",{items:this.$items.sort(a),sortFnc:a})},clear:function(){this.reset([])},size:function(){return this.$items.length}.on("add","remove"),at:function(a){return a<this.$items.length&&a>=0?this.$items[a]:null},each:function(a,b){b=b||this;for(var c=0;c<this.$items.length;c++)a.call(b,this.$items[c],c)}})}),function(a){var b=function(a){this.$context=a||{error:null,actions:[],vars:{}}},c=function(){return new b};b.prototype.seq=function(a,b){a instanceof Function&&(b=a,a=null);if(!b)throw"Sequence action not defined";var c=this;return this.$context.actions.push(function(d){var e=!1,f=function(b,e,f){!b&&a&&(c.$context.vars[a]=e),d(b,f)},g=function(a,b){f(a,b,!1)};g.vars=c.$context.vars;if(b.length){g.end=function(a,b){f(a,b,!0)};try{b.call(g,g)}catch(h){f(h,null)}}else{g.end=function(){e=!0};try{f(null,b.call(g),e)}catch(h){f(h,null,e)}}}),this};var d=function(a,b){if(!b)throw"Parallel action not defined";return function(c,d,e,f){var g=!1,h=function(b,d,g){!b&&a&&(e[a]=d),f(c,b,g)},i=function(a,b){h(a,b,!1)};i.vars=d.vars;if(b.length){i.end=function(a,b){h(a,b,!0)};try{b.call(i,i)}catch(j){h(j,null)}}else{i.end=function(){g=!0};try{h(null,b.call(i),g)}catch(j){h(j,null,g)}}}};b.prototype.par=function(a){if(arguments.length>1)return this.par(Array.prototype.slice.call(arguments)),this;var b=this,c,e;if(a){var f=[];if(a instanceof Array)for(c=0;c<a.length;c++){var g=a[c];f.push(new d(null,g))}else for(e in a)a.hasOwnProperty(e)&&f.push(new d(e,a[e]));f.length>0&&this.$context.actions.push(function(a){(function(a,c){var d={},e,f=function(e,f,g){var h;if(!c)return;if(f||g)c(f,g),c=null;else{var i=a.indexOf(e);if(!(i>=0&&i<a.length)){c("Parallel function returned which wasn't part of this parallel actions"),c=null;return}a.splice(i,1);if(a.length===0){for(h in d)d.hasOwnProperty(h)&&(b.$context.vars[h]=d[h]);c(null,!1),c=null}}},g=a.slice();for(e=0;e<g.length;e++){var h=g[e];h(h,b.$context,d,f)}})(f,a)})}return this},b.prototype.parEach=function(a,b){function e(a,e){c&&(e=a,a=null);var f;b.length>=2?f=function(a){b(e,a)}:f=function(){return b(e)},c?d.push(f):d[a]=f}a=a||[];if(b instanceof Function){var c=a instanceof Array,d=c?[]:{};if(c)for(var f=0;f<a.length;f++)e(a[f]);else for(var g in a)a.hasOwnProperty(g)&&e(g,a[g]);return this.par(d)}throw"2nd argument for parEach needs to be a function"},b.prototype.exec=function(a){function d(a){a<b.$context.actions.length?b.$context.actions[a](function(e,f){e||f?c(e,b.$context.vars):d(a+1)}):c(null,b.$context.vars)}var b=this,c=function(b,c){a&&a(b,c)};d(0)};var e=a.flow;c.noConflict=function(){return a.flow=e,c},a.flow=c}(typeof exports=="undefined"?this:exports),define("flow",function(){return flow}),define("flow",function(){}),define("js/data/Model",["js/core/Bindable","js/core/List","flow","underscore"],function(a,b,c,d){function h(a,b,c){d.each(a,function(a){if(a instanceof g){var d=b[a.className];d&&(d.found=!0,c.push(function(b){a.fetch({fetchSubModels:d.subModels},b)}))}else a instanceof Object&&h(a,b,c)})}function i(a,b,e,f){var g=function(a,b){f&&f(a,b,e)};if(a)g(a,b);else{var i=[];if(e.fetchSubModels&&e.fetchSubModels.length>0){var k=j(b,e.fetchSubModels);h(b.$,k,i);var l=d.filter(k,function(a){return!a.found});if(l.length>0){console.log(["requested submodel missing",l]),g("requested submodel missing",b);return}}c().par(i).exec(function(a){g(a,b)})}}function j(a,b){var c={},e=/^([\w][\w.]*)(?:\/([\w][\w.]*))?$/;return d.each(b,function(b){var d=e.exec(b);if(d){var f=a.$context.$datasource.getModelClassNameForAlias(d[1]),g=d[2],h=c[f];h||(h={type:f,found:!1,subModels:[]}),g&&h.subModels.push(g),c[f]=h}}),c}var e=0,f={CREATED:0,LOADING:1,LOADED:2,ERROR:-1},g=a.inherit("js.data.Model",{ctor:function(a){this.modelClassName=this.constructor.name,this.callBase(a),this.$cid=++e,this._fetch={callbacks:[],state:f.CREATED}},save:function(a,b){this.$context.$datasource.save(a,b)},fetch:function(a,b){a=a||{};var c=this;this._fetch.state===f.LOADING?this._fetch.callbacks.push(function(c,d){i(c,d,a,b)}):this._fetch.state==f.LOADED?i(null,this,a,b):(c._fetch.state=f.LOADING,this.$context.$datasource.loadModel(this,a,function(e,g){c._fetch.state=e?f.ERROR:f.LOADED,i(e,g,a,b),d.each(c._fetch.callbacks,function(a){a(e,g)})}))},remove:function(a,b){this.$context.$datasource.remove(a,b)},prepare:function(){var a={};for(var b in this.$)if(this.$.hasOwnProperty(b)){var c=this.$[b];d.isFunction(c)||(a[b]=c)}return a},parse:function(a){function c(a){for(var e in a)if(a.hasOwnProperty(e)){var f=a[e];if(d.isArray(f)){a[e]=new b(f);for(var g=0;g<f.length;g++)c(f[g])}else f instanceof Object&&c(f)}}return c(a),a},status:function(){return this.$.id===!1?"DELETED":this.$.id?"CREATED":"NEW"}.on("id")});return g}),define("js/html/Input",["js/html/DomElement"],function(a){return a.inherit("js.html.Input",{defaults:{checked:!1},_renderValue:function(a){this.$el.value=a},_renderChecked:function(a){this.$el.checked=a},_bindDomEvents:function(){var a=this;this.$el.type=="text"||this.$el.type=="password"?this.addEventListener("change",function(b){a.set("value",a.$el.value)}):(this.$el.type=="checkbox"||this.$el.type=="radio")&&this.addEventListener("click",function(b){a.set("checked",a.$el.checked)}),this.callBase()}})}),define("js/conf/Configuration",["js/core/Component"],function(a){return a.inherit("js.core.Component",{})}),define("js/conf/Route",["js/conf/Configuration"],function(a){return a.inherit("js.conf.Route",{})}),define("js/core/Router",["js/core/Component","underscore","js/conf/Route"],function(a,b,c){return a.inherit("js.core.Router",{ctor:function(){this.$routes=[],this.callBase()},initialize:function(){this.callBase(),this.$.history?this.history=this.$.history:this.history=this.$systemManager.$application.history,this.history.addRouter(this)},_initializeChildren:function(a){this.callBase()},_childrenInitialized:function(){this.callBase();for(var a=0;a<this.$configurations.length;a++){var b=this.$configurations[a];b instanceof c&&this.addRoute(b.$)}},addRoute:function(){var a;arguments.length==2?a={route:arguments[0],fn:arguments[1]}:a=arguments[0],a.onexec&&(a.fn=this.$rootScope[a.onexec]),b.defaults(a,{name:null,route:null,fn:null}),a.route&&!(a.route instanceof RegExp)&&(a.route=new RegExp(a.route));if(!a.fn||!a.route)throw"fn and route required";this.$routes.push(a)},executeRoute:function(a,b){for(var c=0;c<this.$routes.length;c++){var d=this.$routes[c],e=d.route.exec(a);if(e){var f=function(a,c){b&&b(a,c)};e.shift();var g={callback:f,router:this,params:e,fragment:a};e.unshift(g);var h=this.$rootScope;if(d.fn._async)d.fn.apply(h,e);else try{f(null,d.fn.apply(h,e))}catch(i){f(i)}return!0}}return!1},navigate:function(a,b,c,d){return this.history.navigate(a,b,c,d)}})}),define("js/core/I18n",["require","js/core/Component","underscore"],function(a,b,c){return b.inherit("js.core.I18n",{defaults:{path:"app/locale",locale:null,suffix:".json",translations:{}},initialize:function(){this.callBase(),this.loadLocale(this.$.locale)},_commitChangedAttributes:function(a){a.locale&&this.loadLocale(a.locale)},loadLocale:function(b,c){if(!b)throw"locale not defined";var d=this;a(["json!"+this.$.path+"/"+this.$.locale+this.$.suffix],function(a){d.set({translations:a}),c&&c()})},translate:function(){var a=Array.prototype.slice.call(arguments),b=a.shift(),d;c.isNumber(b)&&(d=b!==1,b=a.shift()),d&&(b+="_plural");var e=this.$.translations[b]||"";for(var f=0;f<a.length;f++)e=e.split("%"+f).join(a[f]);return e}.onChange("translations")})}),define("js/core/Script",["js/core/Element"],function(Element){return Element.inherit("js.core.Script",{evaluate:function(imports){var textContent=this._getTextContentFromDescriptor(this.$descriptor),fn=eval("this.javascript = ("+textContent+")");return fn.apply(this,imports)}})}),define("js/core/Template",["js/core/Component"],function(a){return a.inherit("js.core.Template",{_initializeDescriptors:function(){this._cleanUpDescriptor(this.$descriptor),this._childrenInitialized()},createComponents:function(a,b,c){c=c||this.$rootScope,b=b||this.$parentScope;var d=this._getChildrenFromDescriptor(this.$descriptor);for(var e=0;e<d.length;e++)d[e].$parentScope=b,d[e].$rootScope=c,d[e].set(a),d[e]._initialize("auto",!0);return d}})}),define("js/ui/View",["js/html/DomElement","js/core/Template","js/core/Content","underscore"],function(a,b,c,d){return a.inherit({defaults:{tagName:"div"},$behavesAsDomElement:!1,render:function(){var a=this.$templates.layout;if(a){var b=a.createComponents({},this,this);this._initializeLayoutChildren(b)}return this.callBase()},_initializeLayoutChildren:function(a){for(var b=0;b<a.length;b++)a[b].$rootScope=this,this.addChild(a[b])},_renderChild:function(a){this.callBase();if(a instanceof c){var b=a.get("ref");if(b){var d=this.getPlaceHolder(b);d&&d.set({content:a})}}},_renderLayoutClass:function(a,b){d.each(this.$renderedChildren,function(c){b&&c.removeClass(b),a&&c.addClass(a)})},_renderComponentClass:function(a,b){b&&this.removeClass(b),a&&this.addClass(a)},_renderClass:function(a){a&&this.addClass(a)},_renderTemplateToPlaceHolder:function(a,b,c){this.$renderedPlaceholders=this.$renderedPlaceholders||{};var d=this.$renderedPlaceholders[b];if(!d){var e=this.getTemplate(a);if(e){d=e.createComponents(c)[0];var f=this.getPlaceHolder(b);f&&(f.set({content:d}),this.$renderedPlaceholders[b]=d)}}else d.set(c)},_renderId:function(a){a&&this.$el.setAttribute("id",a)}})}),define("js/ui/ItemsView",["js/ui/View","js/core/Template","js/core/List","underscore"],function(a,b,c,d){return a.inherit({defaults:{tagName:"div",items:null},hasItems:function(){return this.$.items?this.$.items.length:0}.on("items"),render:function(){return this.$renderedItems=[],this.callBase()},clear:function(){},_renderItems:function(a,b){b&&b instanceof c&&(b.unbind("sort",this._onSort),b.unbind("reset",this._onReset),b.unbind("add",this._onItemAdd),b.unbind("remove",this._onItemRemove)),a instanceof c?(a.bind("sort",this._onSort,this),a.bind("reset",this._onReset,this),a.bind("add",this._onItemAdd,this),a.bind("remove",this._onItemRemove,this),this._innerRenderItems(a.$items)):d.isArray(a)&&this._innerRenderItems(a)},_onSort:function(a){if(this.isRendered()){var b,c;for(var d=0;d<a.$.items.length;d++)b=a.$.items[d],c=this.getComponentForItem(b),this.$el.removeChild(c.$el),this.$el.appendChild(c.$el)}},_onReset:function(a){this._innerRenderItems(a.$.items)},_onItemAdd:function(a){this._innerRenderItem(a.$.item,a.$.index)},_onItemRemove:function(a){this._removeRenderedItem(a.$.item)},_innerRenderItems:function(a){if(this.$renderedItems){var b;for(var c=this.$renderedItems.length-1;c>=0;c--)b=this.$renderedItems[c],this.$el.removeChild(b.component.$el)}this.$renderedItems=[];for(var d=0;d<a.length;d++)this._innerRenderItem(a[d],d)},_innerRenderItem:function(a,b){var c=this.$templates.item.createComponents({$item:a,$index:b})[0];this.$renderedItems.push({item:a,component:c}),this.addChild(c)},_removeRenderedItem:function(a){var b;for(var c=0;c<this.$renderedItems.length;c++){b=this.$renderedItems[c];if(b.item===a){this.$el.removeChild(b.component.$el),this.$renderedItems.splice(c,1);return}}},getComponentForItem:function(a){var b;for(var c=0;c<this.$renderedItems.length;c++){b=this.$renderedItems[c];if(b.item===a)return b.component}return null}})}),define("js/core/Injection",["js/core/Component","underscore"],function(a,b){function c(a,b){return a==b||a.prototype instanceof b}return a.inherit("js.core.Injection",{ctor:function(a,b,c,d,e){return c.$injection||(this.callBase(),this.$singletonInstanceCache=[],this.$factories=[],c.$injection=this),c.$injection},_initializeChildren:function(a){this.callBase()},_childrenInitialized:function(){this.callBase();for(var a=0;a<this.$configurations.length;a++){var b=this.$configurations[a];this.addFactory(b.$)}},getInstance:function(a){var d;if(b.isString(a)){if(this.$singletonInstanceCache.hasOwnProperty(a))return this.$singletonInstanceCache[a]}else{for(var e=0;e<this.$singletonInstanceCache.length;e++){d=this.$singletonInstanceCache[e];if(d instanceof a)return d}for(var f=0;f<this.$factories.length;f++){var g=this.$factories[f];if(c(g.factory,a)){d=new g.factory;if(d instanceof a)return g.singleton&&this.addInstance(d),d}}}throw"requested injection type not found"},addChild:function(a){this.callBase(a),this.addInstance(a)},addFactory:function(a){a instanceof Function&&(a={factory:a}),b.defaults(a,{type:null,factory:null,singleton:!1});if(!a.factory){var c=this.$systemManager.$applicationDomain.getDefinition(a.type);if(!c)throw"factory for type '"+a.type+"' not found";a.factory=c}this.$factories.push(a)},addInstance:function(a,b){arguments.length==1&&(b=a,a=null);if(b instanceof Function)throw"got a factory instead of an instance";a?this.$singletonInstanceCache[a]=b:this.$singletonInstanceCache.push(b)}})}),define("js/ui/ContentPlaceHolder",["js/ui/View"],function(a){return a.inherit({_renderContent:function(a){this._clearRenderedChildren(),a&&this._renderChildren(a.$children)}})}),define("js/ui/TextWrapper",["js/ui/View"],function(a){var b=function(a){var b=[],c,d=[],e,f=0;for(var g=0;g<a.length;g++)e=a.charAt(g),e=="["&&d.length===0?(c={},c.start=g,d.push(g)):e=="|"?f=g:e=="]"&&d.length>0&&f>0&&(c.index=parseInt(a.substring(f+1,g)),c.end=g,c.text=a.substring(c.start+1,f),b.push(c),d.pop());return b};return a.inherit({defaults:{tagName:"span"},_getChildrenFromDescriptor:function(a){return[]},_renderChildren:function(){},_renderContentChildren:function(){},_renderString:function(a,c){this.$el.innerHTML="";if(a){var d=b(a),e,f=-1;for(var g=0;g<d.length;g++){e=d[g],e.start>f&&this.$el.appendChild(this.$systemManager.$document.createTextNode(a.substring(f+1,e.start))),f=e.end,this.$viewMap||(this.$viewMap={});var h=e.index+":"+g,i=this.$viewMap[h];i||(i=this._createComponentForNode(this.$descriptor.childNodes[e.index]),i&&(i.$parentScope=this.$parentScope,i.$rootScope=this.$rootScope,this.$viewMap[h]=i)),i?(i.set("$text",e.text),i._initialize("auto",!0),i.isRendered()||i.render(),this.$childViews.push(i),this.$el.appendChild(i.$el)):this.$el.appendChild(this.$systemManager.$document.createTextNode(e.text))}f<a.length&&this.$el.appendChild(this.$systemManager.$document.createTextNode(a.substr(f+1)))}}})}),define("js/data/ListView",["js/core/List","underscore"],function(a,b){return a.inherit("js.data.ListView",{defaults:{filterFnc:function(a,b,c){return!0}},ctor:function(a){this.base.base.ctor.call(this,a);if(!this.$.list)throw"No list defined!";this._bindList(this.$.list)},_unbindList:function(a){a&&(a.unbind("add",this._onItemAdded),a.unbind("remove",this._onItemRemoved),a.unbind("change",this._onItemChange),a.unbind("reset",this._onReset),a.unbind("sort",this._onSort))},_bindList:function(a){a&&(a.bind("add",this._onItemAdded,this),a.bind("remove",this._onItemRemoved,this),a.bind("change",this._onItemChanged,this),a.bind("reset",this._onReset,this),a.bind("sort",this._onSort),this._innerReset(this.$.list.$items))},_onItemAdded:function(b){var c=this._filterItem(b.$.item,b.index);c===!0&&a.prototype.add.call(this,b.$.item,b.index)},_onItemRemoved:function(b){a.prototype.remove.call(this,b.$.item,b.$.index)},_onItemChanged:function(c){var d=this._filterItem(c.$.item,c.$.index),e=b.include(this.$items,c.$.item);e&&d===!1?a.prototype.remove.call(this,c.$.item,c.$.index):!e&&d===!0&&a.prototype.add.call(this,c.$.item,c.$.index)},_onReset:function(a){this._innerReset(a.items)},_onSort:function(b){a.prototype.sort.call(this,b.sortFnc)},_innerReset:function(b){var c=[],d;for(var e=0;e<b.length;e++)d=b[e],this._filterItem(d,e)===!0&&c.push(d);a.prototype.reset.call(this,c)},_commitChangedAttributes:function(a){this.callBase(),a.list&&(this._unbindList(this.$previousAttributes.list),this._bindList(a.list)),this._innerReset(this.$.list.$items)},_filterItem:function(a,b){return this.$.filterFnc.call(this,a,b,this.$.list)},reset:function(){throw"You can't reset a list view!"},add:function(){throw"You can't add items to a list view!"},remove:function(){throw"You can't remove items from a list view"},sort:function(){throw"You can't sort items of a list view"},set:function(){this.callBase()}})});var rAppid;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),function(a,b,c,d,e,f,g,h){if(!c)throw"require.js is needed";if(!d)throw"define is needed";if(!e)throw"underscore is needed";if(!g)throw"flow.js is needed";Function.prototype.async=function(){return this._async=!0,this},c.config({paths:{xaml:"js/plugins/xaml",json:"js/plugins/json"}});var i=/^(xaml!)?(.+?)(\.xml)?$/,j=function(a,b){this.$from=a,this.$to=b},k={"http://www.w3.org/1999/xhtml":"js.html"},l=[new j(/^js.html.(input)$/,"js.html.Input"),new j(/^js.html.(select)$/,"js.html.Select"),new j(/^js.html.(textarea)$/,"js.html.TextArea"),new j(/^js.html.(option)$/,"js.html.Option"),new j(/^js.html.(.+)$/,"js.html.DomElement")],m={createApplicationContext:function(a,f,h,j){h=h||{};var m=function(h){h.xamlClasses=h.xamlClasses||[],h.namespaceMap=h.namespaceMap||k,h.rewriteMap=h.rewriteMap||l,d("flow",[],function(){return g}),d("flow.js",function(){return g}),d("inherit",function(){return b}),d("underscore",function(){return e}),e.extend(h,{paths:{xaml:"js/plugins/xaml",json:"js/plugins/json"}}),h.applicationDomain=a;var m=c.config(h),n=new q(m,h);d("rAppid",function(){return n});if(f){var o=i.exec(f);o?f="xaml!"+o[2]:f=f.replace(/\./g,"/"),m(["require"],function(){m([f],function(a){n.$applicationFactory=a,j(null,n)})})}else j(null,n)};Object.prototype.toString.call(h)=="[object String]"?c(["json!"+h],function(a){m(a)}):m(h)},bootStrap:function(a,b,c){m.createApplicationContext(null,a,b,function(a,b){a||!b?c(a||"ApplicationContext missing"):b.createApplicationInstance(h,c)})},rewriteMapEntry:j,createQueryString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},ajax:function(a,b,c){var d={url:a};e.extend(d,b,m.ajaxSettings);if(d.data&&!e.isString(d.data))throw"data must be a string";d.hasContent=!/^(?:GET|HEAD)$/.test(d.type),d.queryParameter&&e.keys(d.queryParameter).length>0&&(d.url+=/\?/.test(d.url)?"&":"?"+this.createQueryString(d.queryParameter)),d.data&&d.hasContent&&d.contentType!==!1&&f.setRequestHeader("Content-Type",d.contentType);var f=d.xhr();f.open(d.type,d.url,d.async);try{for(var g in d.headers)d.headers.hasOwnProperty(g)&&f.setRequestHeader(g,d.headers[g])}catch(h){}f.send();var i=function(a,b){var d;i&&(b||f.readyState===4)&&(i=undefined,b?f.readyState!==4&&f.abort():d=new o(f),c&&c(b,d))};return!d.async||f.readyState===4?i():f.onreadystatechange=i,f}},n=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,o=b.Base.inherit({ctor:function(a){this.xhr=a,this.status=a.status,this.$nativeResponseHeaders=a.getAllResponseHeaders(),this.responses={};var b=a.responseXML;b&&b.documentElement&&(this.responses.xml=b),this.responses.text=a.responseText;try{this.statusText=a.statusText}catch(c){this.statusText=""}},getResponseHeader:function(a){var b;if(!this.$responseHeaders){this.$responseHeaders={};while(b=n.exec(this.$nativeResponseHeaders))this.$responseHeaders[b[1].toLowerCase()]=b[2]}return this.$responseHeaders[a.toLowerCase()]}});m.ajaxSettings={type:"GET",contentType:"application/x-www-form-urlencoded",async:!0,xhr:function(){return new f},headers:{}};var p=m.SystemManager=b.Base.inherit({ctor:function(a,b,c){this.$requirejsContext=a,this.$applicationContext=b,this.$applicationFactory=null,this.$document=c}}),q=m.ApplicationContext=p.inherit({ctor:function(a,b){this.callBase(a),this.$config=b,this.$applicationContext=this},createApplicationInstance:function(a,b){var c=this.$applicationFactory,d=new p(this.$requirejsContext,this,a);this.$requirejsContext(["js/core/Application"],function(a){var e=new c(null,!1,d,null,null);if(e instanceof a)d.$application=e,e._initialize("auto"),b&&b(null,d,e);else{var f="mainClass isn't an instance of js.core.Application";if(!b)throw f;b(f)}})},getFqClassName:function(a,b,c){if(c==undefined||c==null)c=!0;if(a&&b){a=(this.$config.namespaceMap[a]||a).replace(/\./g,"/");var d=[a,b].join("/")}else d=(a||b).replace(/\./g,"/");e.indexOf(this.$config.xamlClasses,d)!==-1&&(d="xaml!"+d);if(c)for(var f=0;f<this.$config.rewriteMap.length;f++){var g=this.$config.rewriteMap[f];if(g instanceof rAppid.rewriteMapEntry&&g.$from.test(d))return d.replace(g.$from,g.$to)}return d},createInstance:function(a,b,c){function e(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}c=c||a,b=b||[],a=a.replace(/\./g,"/");var d=this.$requirejsContext(a),f;try{f=e(d,b),f.className=c}catch(g){console.log("Cannot create instance of '"+a+"'")}return f},ajax:function(a,b,c){!/^http.*$/.test(a)&&this.$config.applicationUrl&&(a=this.$config.applicationUrl+"/"+a),m.ajax(a,b,c)}});rAppid=a.rAppid=m}(typeof exports=="undefined"?this:exports,typeof inherit=="undefined"?require("inherit.js").inherit:inherit,typeof requirejs=="undefined"?require("requirejs"):requirejs,typeof requirejs=="undefined"?require("requirejs").define:define,typeof this._=="undefined"?require("underscore"):this._,typeof window=="undefined"?require("xmlhttprequest").XMLHttpRequest:window.XMLHttpRequest,typeof flow=="undefined"?require("flow.js").flow:flow,typeof document=="undefined"?new(require("xmldom").DOMParser):document),define("js/lib/rAppid",function(){})